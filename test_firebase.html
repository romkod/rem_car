<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è Firebase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body>
    <h1>–¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è Firebase</h1>
    
    <div class="test-section">
        <h2>1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Firebase SDK</h2>
        <div id="sdkStatus" class="status info">–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞...</div>
    </div>
    
    <div class="test-section">
        <h2>2. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Firebase</h2>
        <div id="initStatus" class="status info">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...</div>
        <button onclick="testInit()">–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Firebase</button>
    </div>
    
    <div class="test-section">
        <h2>3. –¢–µ—Å—Ç –∑–∞–ø–∏—Å—É –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö</h2>
        <div id="writeStatus" class="status info">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...</div>
        <button onclick="testWrite()">–ó–∞–ø–∏—Å–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ</button>
    </div>
    
    <div class="test-section">
        <h2>4. –¢–µ—Å—Ç —á–∏—Ç–∞–Ω–Ω—è –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö</h2>
        <div id="readStatus" class="status info">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...</div>
        <button onclick="testRead()">–ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ</button>
        <pre id="readData"></pre>
    </div>
    
    <div class="test-section">
        <h2>5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª –±–µ–∑–ø–µ–∫–∏</h2>
        <div id="rulesStatus" class="status info">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...</div>
        <button onclick="testRules()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCNZ3vvBe_WHG4VuvpjQJttcN_y3aRnHKg",
            authDomain: "remcar-a23dc.firebaseapp.com",
            databaseURL: "https://remcar-a23dc-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "remcar-a23dc",
            storageBucket: "remcar-a23dc.firebasestorage.app",
            messagingSenderId: "501067679866",
            appId: "1:501067679866:web:007744a897f8d83275d3c3",
            measurementId: "G-22BSZF8J10"
        };

        let database = null;
        let firebaseInitialized = false;

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ SDK
        window.addEventListener('DOMContentLoaded', () => {
            if (typeof firebase !== 'undefined') {
                document.getElementById('sdkStatus').className = 'status success';
                document.getElementById('sdkStatus').textContent = '‚úÖ Firebase SDK –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ';
            } else {
                document.getElementById('sdkStatus').className = 'status error';
                document.getElementById('sdkStatus').textContent = '‚ùå Firebase SDK –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ';
            }
        });

        // –¢–µ—Å—Ç —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
        function testInit() {
            const statusEl = document.getElementById('initStatus');
            try {
                if (typeof firebase === 'undefined') {
                    statusEl.className = 'status error';
                    statusEl.textContent = '‚ùå Firebase SDK –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ';
                    return;
                }

                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                firebaseInitialized = true;
                
                statusEl.className = 'status success';
                statusEl.innerHTML = `‚úÖ Firebase —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ!<br>
                    Database URL: ${database.app.options.databaseURL}`;
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.innerHTML = `‚ùå –ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó:<br>${error.message}`;
            }
        }

        // –¢–µ—Å—Ç –∑–∞–ø–∏—Å—É
        async function testWrite() {
            const statusEl = document.getElementById('writeStatus');
            
            if (!firebaseInitialized || !database) {
                statusEl.className = 'status error';
                statusEl.textContent = '‚ùå –°–ø–æ—á–∞—Ç–∫—É —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–π—Ç–µ Firebase';
                return;
            }

            try {
                statusEl.className = 'status info';
                statusEl.textContent = '‚è≥ –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö...';
                
                const testRef = database.ref('test/connection');
                await testRef.set({
                    timestamp: Date.now(),
                    message: '–¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è',
                    status: 'success'
                });
                
                statusEl.className = 'status success';
                statusEl.textContent = '‚úÖ –î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ñ –≤ /test/connection';
            } catch (error) {
                statusEl.className = 'status error';
                let errorMsg = `‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Å—É:<br>${error.message}<br>–ö–æ–¥: ${error.code || 'N/A'}`;
                
                if (error.code === 'PERMISSION_DENIED') {
                    errorMsg += '<br><br><strong>üîß –†–Ü–®–ï–ù–ù–Ø:</strong><br>';
                    errorMsg += '1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ <a href="https://console.firebase.google.com/" target="_blank">Firebase Console</a><br>';
                    errorMsg += '2. –í–∏–±–µ—Ä—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç: <strong>remcar-a23dc</strong><br>';
                    errorMsg += '3. Realtime Database ‚Üí <strong>Rules</strong><br>';
                    errorMsg += '4. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø—Ä–∞–≤–∏–ª–∞ (–¥–∏–≤. FIREBASE_RULES_SETUP.md)<br>';
                    errorMsg += '5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å <strong>"Publish"</strong>';
                }
                
                statusEl.innerHTML = errorMsg;
            }
        }

        // –¢–µ—Å—Ç —á–∏—Ç–∞–Ω–Ω—è
        async function testRead() {
            const statusEl = document.getElementById('readStatus');
            const dataEl = document.getElementById('readData');
            
            if (!firebaseInitialized || !database) {
                statusEl.className = 'status error';
                statusEl.textContent = '‚ùå –°–ø–æ—á–∞—Ç–∫—É —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–π—Ç–µ Firebase';
                return;
            }

            try {
                statusEl.className = 'status info';
                statusEl.textContent = '‚è≥ –ß–∏—Ç–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö...';
                
                // –ß–∏—Ç–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
                const testRef = database.ref('test/connection');
                const snapshot = await testRef.once('value');
                const testData = snapshot.val();
                
                // –ß–∏—Ç–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤
                const carsRef = database.ref('cars');
                const carsSnapshot = await carsRef.once('value');
                const carsData = carsSnapshot.val();
                
                statusEl.className = 'status success';
                statusEl.textContent = '‚úÖ –î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ';
                
                dataEl.textContent = JSON.stringify({
                    test: testData,
                    cars: carsData
                }, null, 2);
            } catch (error) {
                statusEl.className = 'status error';
                let errorMsg = `‚ùå –ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è:<br>${error.message}<br>–ö–æ–¥: ${error.code || 'N/A'}`;
                
                if (error.code === 'PERMISSION_DENIED') {
                    errorMsg += '<br><br><strong>üîß –†–Ü–®–ï–ù–ù–Ø:</strong><br>';
                    errorMsg += '1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ <a href="https://console.firebase.google.com/" target="_blank">Firebase Console</a><br>';
                    errorMsg += '2. –í–∏–±–µ—Ä—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç: <strong>remcar-a23dc</strong><br>';
                    errorMsg += '3. Realtime Database ‚Üí <strong>Rules</strong><br>';
                    errorMsg += '4. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø—Ä–∞–≤–∏–ª–∞ (–¥–∏–≤. FIREBASE_RULES_SETUP.md)<br>';
                    errorMsg += '5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å <strong>"Publish"</strong>';
                }
                
                statusEl.innerHTML = errorMsg;
                dataEl.textContent = '';
            }
        }

        // –¢–µ—Å—Ç –ø—Ä–∞–≤–∏–ª
        async function testRules() {
            const statusEl = document.getElementById('rulesStatus');
            
            if (!firebaseInitialized || !database) {
                statusEl.className = 'status error';
                statusEl.textContent = '‚ùå –°–ø–æ—á–∞—Ç–∫—É —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–π—Ç–µ Firebase';
                return;
            }

            try {
                statusEl.className = 'status info';
                statusEl.textContent = '‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª...';
                
                // –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å–∞—Ç–∏ –≤ /cars
                const carsRef = database.ref('cars/test-car');
                await carsRef.set({
                    brand: 'Test',
                    model: 'Test Model'
                });
                
                // –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏
                const snapshot = await carsRef.once('value');
                const data = snapshot.val();
                
                // –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
                await carsRef.remove();
                
                statusEl.className = 'status success';
                statusEl.innerHTML = `‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!<br>
                    –ó–∞–ø–∏—Å —Ç–∞ —á–∏—Ç–∞–Ω–Ω—è –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ.`;
            } catch (error) {
                statusEl.className = 'status error';
                let message = `‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª:<br>${error.message}<br>–ö–æ–¥: ${error.code || 'N/A'}`;
                
                if (error.code === 'PERMISSION_DENIED') {
                    message += '<br><br>üîß –†–Ü–®–ï–ù–ù–Ø:<br>';
                    message += '1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ <a href="https://console.firebase.google.com/" target="_blank">Firebase Console</a><br>';
                    message += '2. –í–∏–±–µ—Ä—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç: <strong>remcar-a23dc</strong><br>';
                    message += '3. Realtime Database ‚Üí <strong>Rules</strong> (–≤–∫–ª–∞–¥–∫–∞)<br>';
                    message += '4. –°–∫–æ–ø—ñ—é–π—Ç–µ —Ç–∞ –≤—Å—Ç–∞–≤—Ç–µ —Ü—ñ –ø—Ä–∞–≤–∏–ª–∞:<br>';
                    message += '<pre style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin-top: 10px; text-align: left; max-width: 600px; overflow-x: auto;">{\n  "rules": {\n    "cars": {\n      ".read": true,\n      ".write": true,\n      "$carId": {\n        ".read": true,\n        ".write": true,\n        "categories": {\n          ".read": true,\n          ".write": true\n        }\n      }\n    },\n    "test": {\n      ".read": true,\n      ".write": true\n    }\n  }\n}</pre>';
                    message += '5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É <strong>"Publish"</strong> (–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏)<br>';
                    message += '6. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è "Rules published successfully"<br>';
                    message += '7. –û–Ω–æ–≤—ñ—Ç—å —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É (F5) —Ç–∞ —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–æ–≤—É<br><br>';
                    message += 'üìñ –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è: –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª <strong>FIREBASE_RULES_SETUP.md</strong>';
                }
                
                statusEl.innerHTML = message;
            }
        }
    </script>
</body>
</html>

